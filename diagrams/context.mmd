
flowchart TB
  subgraph Customer["Customer Org"]
    IdP["IdP (Okta / Entra ID)"]
    SN["ServiceNow (Cloud ITSM)"]
    Slack["Slack (Cloud)"]
    GH["GitHub (Cloud)"]
    Users["Users (Operators / Approvers / Builders)"]
  end

  subgraph SaaS["Our Platform (Region-pinned Cell)"]
    UI["Web UI (Admin / Builder / Ops)"]
    CP["Control Plane API (Go)"]
    PDP["Policy System (OPA/Rego)"]
    EP["Execution Plane (Workers)"]
    CG["Connector Gateway (PEP)"]
    Evidence["Evidence Store (Audit + Approval Artifacts)"]
    Meter["Metering/FinOps"]
  end

  subgraph Agent["Optional Outbound Agent (Customer Network)"]
    Runner["Agent/Runner (mTLS, store-and-forward)"]
  end

  Users --> UI
  UI --> CP
  CP --> PDP
  CP --> Evidence
  CP --> Meter

  SN -- webhooks --> CP
  CP --> EP
  EP --> PDP
  EP --> CG
  CG --> SN
  CG --> Slack
  CG --> GH

  Slack --> UI
  Slack --> CP

  CP <--> IdP

  EP --> Evidence
  EP --> Meter

  Runner --> SaaS
  Runner --> SN
  Runner --> GH
